<!DOCTYPE html>
<html>
<head>
    <title>Create Poll</title>
    <link rel="stylesheet" type="text/css" href="/css/styles.css">
</head>
<body>
    <h1>Create Poll</h1>
    <form id="pollForm">
        <label for="question">Question:</label>
        <input type="text" id="question" name="question" required><br><br>
        
        <label for="option1">Option 1:</label>
        <input type="text" id="option1" name="options" required><br>
        <label for="option2">Option 2:</label>
        <input type="text" id="option2" name="options" required><br>
        <label for="option3">Option 3:</label>
        <input type="text" id="option3" name="options" required><br>
        <label for="option4">Option 4:</label>
        <input type="text" id="option4" name="options" required><br>
        <!-- You can add more input fields for additional options -->
        
        <button type="submit">Create Poll</button>
    </form>

    <script>
        // Flag to track whether form has been submitted
        let formSubmitted = false;
        document.getElementById("pollForm").addEventListener("submit", function(event) {
        // Prevent default form submission if not already submitted
        if (!formSubmitted) {
                event.preventDefault(); // Prevent default form submission
                formSubmitted = true; // Set flag to true to prevent further submissions
         
            // Construct JSON data object
            const formData = {
                question: document.getElementById("question").value,
                options: [
                    document.getElementById("option1").value,
                    document.getElementById("option2").value,
                    document.getElementById("option3").value,
                    document.getElementById("option4").value
                    // Add more options as needed
                ]
            };

            // Send JSON data to backend using Fetch API
            fetch("/api/polls", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(formData)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error("Network response was not ok");
                }
                return response.json();
            })
            .then(data => {
                console.log(data); // Handle successful response
            })
            .catch(error => {
                console.error("There was a problem with your fetch operation:", error); // Handle error
            });
        }
    });
    </script>
</body>
</html>
